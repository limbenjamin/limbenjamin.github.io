/**
 * (c) Copyright 2018 GfK SE. All rights reserved.
 */
gfkSsaApiConf = {"projectVersion":"1.0","enabled":true,"project":"sg1","version":"2","tech":"ssa-w","trackingUrl":"sg1-ssa.sensic.net","dnt":false,"panelIdentUrl":"sg-config.sensic.net","panelIdentFile":"suiapi.js","forceImpressionTime":3,"heartbeat":{"enabled":true,"interval":[5,10,15,20,60],"maximum":0,"restart":true},"systemParams":{"version":true,"useragent":true,"referer":true,"os":true,"lang":true},"customParams":[{"name":"cp1","validation":".*"},{"name":"cp2","validation":".*"},{"name":"cp3","validation":".*"},{"name":"cp4","validation":".*"},{"name":"cp5","validation":".*"},{"name":"cp6","validation":".*"},{"name":"cp7","validation":".*"},{"name":"cp8","validation":".*"},{"name":"cp9","validation":".*"},{"name":"cp10","validation":".*"},{"name":"cp11","validation":".*"},{"name":"cp12","validation":".*"},{"name":"cp13","validation":".*"},{"name":"cp14","validation":".*"},{"name":"cp15","validation":".*"},{"name":"cp16","validation":".*"},{"name":"cp17","validation":".*"},{"name":"cp18","validation":".*"},{"name":"cp19","validation":".*"},{"name":"cp20","validation":".*"},{"name":"cp21","validation":".*"},{"name":"cp22","validation":".*"},{"name":"cp23","validation":".*"},{"name":"cp24","validation":".*"},{"name":"cp25","validation":".*"}]};!function(){function t(){R.on(w,this.postToBackend),R.on(k,this.postToBackend)}function e(){"function"==typeof gfkSsaConf.debug?(R.on(k,this.logToFunction),R.on(w,this.logToFunction)):(R.on(k,this.logToConsole),R.on(w,this.logToConsole))}function n(t,e,n){var i=n||window,r=t||window.gfk.ssa,a=null,s=e||null,o=0,u=null,p=!1;this.notifyLoaded=function(t,e,n){d()&&this.notifyIdle(n||null),p=!1,u={contentId:t,customInitParameters:e}},this.notifyPlay=function(t){c()&&(d()||(p?r.processEvent("play",t||null,a):a=r.processEvent("init",t||null,u.contentId,s,u.customInitParameters),o=i.setInterval(h,200),p=!1))},this.notifyIdle=function(t){c()&&d()&&(r.processEvent("interrupt",t||null,a),i.clearInterval(o),o=0,p=!0)},this.notifySkipped=function(t){c()&&(d()||p)&&(r.processEvent("interrupt",t||null,a,1),i.clearInterval(o),o=0,p=!1)};var d=function(){return!!o},c=function(){return null!=u},h=function(){r.processEvent("heartbeat",null,a)}}function i(){_=[]}function r(){if(Z&&null!=$||Z&&Y){if(_.length>0){for(var t=0;t<_.length;t++){var e=a(_[t]);R.trigger(e,_[t])}_=[]}return!0}return!1}function a(t){return t.getType()==f.prototype.getType()?w:I}function s(t){$=t}function o(){R.on(I,this.validate)}function u(){this.subscribers={},this.subscribersHasOwnProperty=this.subscribers.hasOwnProperty}function p(){var t=this;this.stoppedVideos=[],R.on(S,function(e){for(var n=0;n<t.stoppedVideos.length;n++)if(e.presentationId==t.stoppedVideos[n].presentationId){t.stoppedVideos.splice(n,1);break}}),R.on(C,function(e){d(e,t.stoppedVideos,!0)}),R.on(T,function(e){t.stoppedVideos.push(e)})}function d(t,e,n){if(n)for(var i=0;i<e.length;i++)if(t.presentationId==e[i].presentationId)return;t.eventType="H",R.trigger(k,t)}function c(){this.readyStatusCode=4}function h(t,e,n,i,r){this.contentId=e,this.presentationId=n,this.mediaId=i,this.customData=r,this.valid=!0,this.viewTime=H.getViewtime(this.presentationId).getTimeInSeconds(t),this.requestNumber=H.getRequestNumber(this.presentationId)}function l(){this.requestNumbers=[],this.heartbeats=[],this.lastHeartbeats=[],this.viewtimes=[]}function f(t,e,n,i){this.presentationId=n,this.eventType=t,this.viewTime=H.getViewtime(this.presentationId).getTimeInSeconds(e),this.requestNumber=H.getRequestNumber(this.presentationId),this.skippedContent=i}function m(t,e){W="/"==t.charAt(t.length-1)?t.substring(0,t.length-1):t,this.loadSuiAPI(t,e)}function v(t){s(t)}function g(){this.reset()}var b={initialize:function(){N&&!L&&(this.dataProcessor=new i,new m(K,Q),q.enabled&&new p(q),new o,gfkSsaConf.debug?new e:new t,Z=!0)},processEvent:function(t,e,n,i,r){switch(t){case"init":return b.initEvent(e,n,i,r);case"play":b.playEvent(e,n);break;case"heartbeat":b.heartbeatEvent(e,n);break;case"interrupt":b.interruptEvent(e,n,i);break;case"finish":b.finishEvent(e,n)}},initEvent:function(t,e,n,i){var r=H.newPresentationId(e);return N&&!L&&(this.dataProcessor.initEvent(t,e,r,n,i),H.getViewtime(r).resume(t),q.enabled&&(H.updateLastHeartbeat(r),R.trigger(S,new f("HeartbeatInit",t,r)),H.decreaseRequestNumber(r))),r},playEvent:function(t,e){N&&!L&&(H.getViewtime(e).resume(t),q.enabled&&(H.updateLastHeartbeat(e),R.trigger(S,new f("HeartbeatInit",t,e)),H.decreaseRequestNumber(e)))},heartbeatEvent:function(t,e){N&&!L&&q.enabled&&(H.isHeartbeatMaximumReached(e)||new Date-H.getLastHeartbeat(e)>H.getCurrentHeartbeatInterval(e)&&(H.increaseCurrentHeartbeatCount(e),H.updateLastHeartbeat(e),R.trigger(C,new f("HeartbeatRenewal",t,e))))},interruptEvent:function(t,e,n){this.interruptedEvent("E",t,e,n)},finishEvent:function(t,e){this.interruptedEvent("F",t,e,0)},interruptedEvent:function(t,e,n,i){N&&!L&&(H.getViewtime(n).pause(e),q.enabled?(R.trigger(T,new f("HeartbeatStop",e,n)),H.decreaseRequestNumber(n),this.dataProcessor.freshEvent(t,e,n,i),H.isHeartbeatIntervalRestartEnabled()&&H.resetCurrentHeartbeatCount(n)):this.dataProcessor.freshEvent(t,e,n,i))},getAgent:function(t,e){var i,r=0;for(i in this.trackers)r++;0==r&&b.initialize();var a=null,s=null==e?t:e;return this.trackers[s]&&this.trackers[s].mediaId==t?a=this.trackers[s].tracker:(this.trackers[s]&&this.trackers[s].mediaId!=t&&(a=this.trackers[s].tracker,a.notifyIdle()),a=new n(b,t),this.trackers[s]={tracker:a,mediaId:t}),a},notifyAllAgentsIdle:function(){for(var t in this.trackers){var e=this.trackers[t].tracker;e.notifyIdle()}},trackers:{}};"undefined"==typeof window.gfk&&(window.gfk={});var y=[];"undefined"!=typeof window.gfk.ssa&&(y=window.gfk.ssa.agents),window.gfk.ssa=b,t.prototype.postToBackend=function(t){var e=new c;e.httpPost(x,t.toUrlEncodedString())},e.prototype.logToConsole=function(t){},e.prototype.logToFunction=function(t){gfkSsaConf.debug.call(document,t)},i.prototype.initEvent=function(t,e,n,i,a){var s=new h(t,e,n,i,a);this.pushData(s),setTimeout(function(){Y=!0,r()},G)},i.prototype.freshEvent=function(t,e,n,i){var r=new f(t,e,n,i);this.pushData(r)},i.prototype.pushData=function(t){if(r()){var e=a(t);R.trigger(e,t)}else _.push(t)},o.prototype.validate=function(t){if(t.getType()==h.prototype.getType())if(null!=J){var e=0;if(null!=t.customData)for(var n in t.customData)e++;if(J.length>=e)for(var i=0;i<J.length&&null!=t.customData;i++){var r=t.customData[J[i].name];if(null!=r){var a=new RegExp(J[i].validation);if(!a.test(r)){t.valid=!1;break}t.valid=!0}}else t.valid=!1}else null==J&&null==t.customData?t.valid=!0:t.valid=!1;R.trigger(w,t)},u.prototype.on=function(t,e){this.subscribersHasOwnProperty.call(this.subscribers,t)||(this.subscribers[t]=[]);var n=this.subscribers[t].push(e)-1;return{remove:function(){delete this.subscribers[t][n]}}},u.prototype.trigger=function(t,e){if(this.subscribersHasOwnProperty.call(this.subscribers,t))for(var n=0;n<this.subscribers[t].length;n++){var i=this.subscribers[t][n];i.call(document,void 0!=e?e:{})}};var w="send",I="validate",k="heartbeat",S="heartbeatInit",C="heartbeatRenewal",T="heartbeatStop",R=new u,H=new l,E=document.URL,D=window.navigator.userAgent,A=window.navigator.language||window.navigator.userLanguage,P=window.navigator.oscpu||window.navigator.platform,U=window.location.protocol+"//";"http://"!=U&&"https://"!=U&&(U="https://");var q=gfkSsaApiConf.heartbeat,N=gfkSsaApiConf.enabled,L=gfkSsaApiConf.dnt&&(1==navigator.msDoNotTrack||1==window.doNotTrack||1==navigator.doNotTrack),x=gfkSsaApiConf.trackingUrl.indexOf(U)!=-1?gfkSsaApiConf.trackingUrl:U+gfkSsaApiConf.trackingUrl,V=gfkSsaApiConf.tech,M=gfkSsaApiConf.project,O=gfkSsaApiConf.projectVersion+"/2.4.1/"+gfkSsaApiConf.version,F=gfkSsaApiConf.systemParams.version,B=gfkSsaApiConf.systemParams.useragent,j=gfkSsaApiConf.systemParams.referer,X=gfkSsaApiConf.systemParams.os,z=gfkSsaApiConf.systemParams.lang,J=gfkSsaApiConf.customParams,G=1e3*gfkSsaApiConf.forceImpressionTime,K=gfkSsaApiConf.panelIdentUrl.indexOf(U)!=-1?gfkSsaApiConf.panelIdentUrl:U+gfkSsaApiConf.panelIdentUrl,Q=gfkSsaApiConf.panelIdentFile,W=null,Y=!1,Z=!1,$=null,_=null;if(c.prototype.httpPost=function(t,e){var n=null;window.XDomainRequest?(n=new XDomainRequest,n.open("POST",t,!0)):(n=new XMLHttpRequest,n.open("POST",t,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded")),n.send(e)},h.prototype.getType=function(){return"InitData"},h.prototype.toFormattedString=function(){var t="{\n Technology: '"+V+"',\n Content ID: '"+this.contentId+"',\n Media ID: '"+this.mediaId+"',\n Project ID: '"+M+"',\n "+(F?"API Version: '"+O+"',\n ":"")+(j?"Visited publisher site: '"+E+"',\n ":"")+(B?"UserAgent: '"+D+"',\n ":"")+(z?"Language: '"+A+"',\n ":"")+(X?"Operating system: '"+P+"',\n ":"")+"User ID: '"+$+"',\n Presentation ID: '"+this.presentationId+"',\n View time: '"+this.viewTime+"'\n Request type: 'I' (INIT)\n Request number: '"+this.requestNumber+"'";if(null==this.customData)return t+",\n Invalid: "+this.valid+"\n}";var e=",\n Custom data: {\n ";for(var n in this.customData)e+=" "+n+": '"+(this.customData.hasOwnProperty(n)?this.customData[n]:"'null'")+"',\n ";return e=e.substr(0,e.length-3)+"\n },\n Invalid: '"+!this.valid+"' \n}",t+e},h.prototype.getHostFromUri=function(t){var e=document.createElement("a");return e.href=t,e.hostname},h.prototype.toUrlEncodedString=function(){var t="t="+encodeURIComponent(V)+"&c="+encodeURIComponent(this.contentId)+"&m="+encodeURIComponent(this.mediaId)+"&p="+encodeURIComponent(M)+(F?"&v="+encodeURIComponent(O):"")+(j?"&r="+this.getHostFromUri(encodeURIComponent(E)):"")+(B?"&ua="+encodeURIComponent(D):"")+(z?"&l="+encodeURIComponent(A):"")+(X?"&os="+encodeURIComponent(P):"")+"&cu="+encodeURIComponent($)+"&pr="+encodeURIComponent(this.presentationId)+"&vt="+encodeURIComponent(this.viewTime)+"&ty=I&no="+encodeURIComponent(this.requestNumber);if(null==this.customData)return t+(this.valid?"":"&invalid="+!this.valid);var e="";for(var n in this.customData)e+="&"+encodeURIComponent(n)+"="+(this.customData.hasOwnProperty(n)?encodeURIComponent(this.customData[n]):"null");return e+=this.valid?"":"&invalid="+!this.valid,t+e},l.prototype.getViewtime=function(t){for(var e=0;e<this.viewtimes.length;e++)if(this.viewtimes[e].id==t)return this.viewtimes[e].viewtime;var n=new g;return this.viewtimes.push({id:t,viewtime:n}),n},l.prototype.updateLastHeartbeat=function(t){for(var e=0;e<this.lastHeartbeats.length;e++)if(this.lastHeartbeats[e].id==t){var n=this.lastHeartbeats[e].lastHeartbeart;return this.lastHeartbeats[e].lastHeartbeart=new Date,n}var n=new Date;return this.lastHeartbeats.push({id:t,lastHeartbeart:n}),n},l.prototype.getLastHeartbeat=function(t){for(var e=0;e<this.lastHeartbeats.length;e++)if(this.lastHeartbeats[e].id==t)return this.lastHeartbeats[e].lastHeartbeart;var n=new Date;return this.lastHeartbeats.push({id:t,lastHeartbeart:n}),n},l.prototype.getRequestNumber=function(t){for(var e=0;e<this.requestNumbers.length;e++)if(this.requestNumbers[e].id==t)return this.requestNumbers[e].number++;return this.requestNumbers.push({id:t,number:1}),0},l.prototype.decreaseRequestNumber=function(t){for(var e=0;e<this.requestNumbers.length;e++)this.requestNumbers[e].id==t&&(this.requestNumbers[e].number-=1)},l.prototype.isHeartbeatMaximumSet=function(){return null!=q.maximum&&0!=q.maximum},l.prototype.isHeartbeatMaximumReached=function(t){if(this.isHeartbeatMaximumSet())for(var e=0;e<this.heartbeats.length;e++)if(this.heartbeats[e].id==t)return q.maximum<this.heartbeats[e].count;return!1},l.prototype.isHeartbeatIntervalRestartEnabled=function(){return null!=q.restart&&0!=q.restart},l.prototype.getCurrentHeartbeatInterval=function(t){for(var e=0;e<this.heartbeats.length;e++)if(this.heartbeats[e].id==t){var n=this.heartbeats[e].intervalIndex;return this.isHeartbeatMaximumReached(t)?null:1e3*this.heartbeats[e].intervals[n]}var i=null!=q.interval.length?q.interval:[q.interval];return this.heartbeats.push({id:t,intervals:i,intervalIndex:0,count:1}),1e3*i[0]},l.prototype.increaseCurrentHeartbeatCount=function(t){for(var e=0;e<this.heartbeats.length;e++)this.heartbeats[e].id==t&&(this.heartbeats[e].count++,this.heartbeats[e].intervalIndex<this.heartbeats[e].intervals.length-1&&this.heartbeats[e].intervalIndex++)},l.prototype.resetCurrentHeartbeatCount=function(t){for(var e=0;e<this.heartbeats.length;e++)this.heartbeats[e].id==t&&(this.heartbeats[e].intervalIndex=0)},l.prototype.newPresentationId=function(t){return t+"-"+(new Date).getTime()+"-"+Math.floor(1e4*Math.random())},f.prototype.getType=function(){return"TrackedData"},f.prototype.toFormattedString=function(){return"{\n Presentation ID: '"+this.presentationId+"',\n Viewtime: '"+this.viewTime+"'\n Request type: '"+this.eventType+"'"+("E"==this.eventType?"(END/PAUSE)":"H"==this.eventType?"(HEARTBEAT)":"")+",\n Request number: '"+this.requestNumber+"'\n"+("E"==this.eventType?" Skipped: '"+(1==this.skippedContent)+"'\n}":"}")},f.prototype.toUrlEncodedString=function(){return"pr="+this.presentationId+"&vt="+encodeURIComponent(this.viewTime)+"&ty="+encodeURIComponent(this.eventType)+"&no="+encodeURIComponent(this.requestNumber)+(1==this.skippedContent&&"E"==this.eventType?"&sk=1":"")},m.prototype.loadSuiAPI=function(t,e){var n=document.getElementsByTagName("script")[0],i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=t+"/"+e;var r=this;i.readyState?i.onreadystatechange=function(){"loaded"!==i.readyState&&"complete"!==i.readyState||(i.onreadystatechange=null,r.processSui())}:i.onload=this.processSui,n?n.parentNode.insertBefore(i,n):document.body&&document.body.appendChild(i)},m.prototype.processSui=function(){SuiApi.init(function(t){var e=SuiApi.objectToJsonString(t);v(e)})},g.prototype.IDLE=-1,g.prototype.reset=function(){this.time=0,this.lastResumeTimestamp=this.IDLE},g.prototype.resume=function(){this.isIdle()&&(this.lastResumeTimestamp=arguments[0]||(new Date).getTime())},g.prototype.pause=function(){if(!this.isIdle()){var t=arguments[0]||(new Date).getTime();this.time+=t-this.lastResumeTimestamp,this.lastResumeTimestamp=this.IDLE}},g.prototype.getTimeInSeconds=function(){return this.getTimeInMillis()/1e3},g.prototype.getTimeInMillis=function(){if(this.isIdle())return this.time;var t=arguments[0]||(new Date).getTime();return this.time+(t-this.lastResumeTimestamp)},g.prototype.isIdle=function(){return this.lastResumeTimestamp==this.IDLE},y&&y.length>0)for(var tt=0;y&&tt<y.length;tt++){var et=y[tt],nt=et.a[0]||null,it=et.a[1]||null,rt=gfk.ssa.getAgent(nt,it);et.notifyLoaded=rt.notifyLoaded,et.notifyPlay=rt.notifyPlay,et.notifyIdle=rt.notifyIdle,et.notifySkipped=rt.notifySkipped;for(var at=0;et.queue&&at<et.queue.length;at++){var st=et.queue[at],ot=st.f,ut=st.t,pt=st.a;switch(ot){case"notifyLoaded":var dt=pt[0]||null,ct=pt[1]||{};rt.notifyLoaded(dt,ct,ut);break;case"notifyPlay":rt.notifyPlay(ut);break;case"notifyIdle":rt.notifyIdle(ut);break;case"notifySkipped":rt.notifySkipped(ut)}}}"complete"==document.readyState||"interactive"==document.readyState?"function"==typeof window.onSsaReady&&window.onSsaReady.call(document,window.onSsaReady):document.onreadystatechange=function(){"complete"!=document.readyState&&"interactive"!=document.readyState||"function"==typeof window.onSsaReady&&window.onSsaReady.call(document,window.onSsaReady)}}();