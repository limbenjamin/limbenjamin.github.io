var _ain=_ain||{};_ain.version=11,_ain.E_NO_EL=1,_ain.E_INV_EL=2,_ain.E_NO_SOC=3,_ain.E_LSTN=4,_ain.E_INCORRECT_OPTION_ACCESS_LEVEL=5,_ain.E_INCORRECT_OPTION_READER_TYPE=6,_ain.errors=[],_ain.config={pv_url:["ingestion.contentinsights.com/p"],at_url:["ingestion.contentinsights.com/a"]},_ain.track=function(){if(!_ain.id)return!1;_ain.running=!0,_ain.init()},_ain.stop=function(){_ain.running=!1},_ain.init=function(){function sendRequest(t,e){if(!1===_ain.running)return!1;for(var n=0;n<t.length;n++)(new Image).src=("https:"==document.location.protocol?"https":"http")+"://"+t[n]+e}function getSocial(t,e){function n(t,e,n,i){if("undefined"!=typeof Worker){void 0===i&&(i="");var a="";for(var o in e)a+="&"+o+"="+e[o];var r=new Blob([i+"var cb = function(val) { postMessage(val) };try { importScripts('"+t+"?callback=cb"+a+"&x="+Math.random()+"'); } catch (ex) {}"],{type:"text/javascript"}),s=window.URL.createObjectURL(r),c=new Worker(s);c.onmessage=function(t){n(t),c.terminate()},c.onerror=function(){},setTimeout(function(){c.terminate()},1e4)}}for(var i=["fb_count","vk_like","vk_share","ok_count","ln_count","pn_count","gp_count"],a=[0,1,2],o=[4,2,1],r=0,s=0;s<o.length;s++)r+=o[s];for(var c=[],u=0;u<a.length;){for(s=0;s<o[u];s++)c[c.length]=a[u];u++}switch(c[Math.floor(Math.random()*r)]){case 0:break;case 1:isSocialCountPredefined("fb_count")||n("https://graph.facebook.com/",{format:"jsonp",id:t,fields:"og_object{engagement{count}}"},function(t){var n="";void 0!==t.data.og_object&&(n+="&fb_count="+t.data.og_object.engagement.count),void 0!==t.data.share&&(n+="&fb_share_count="+t.data.share.share_count),e(n)}),isSocialCountPredefined("ln_count")||n("https://www.linkedin.com/countserv/count/share",{format:"jsonp",url:t},function(t){void 0!==t.data.count&&e("&ln_count="+t.data.count)}),isSocialCountPredefined("pn_count")||n("https://api.pinterest.com/v1/urls/count.json",{url:t},function(t){void 0!==t.data.count&&e("&pn_count="+t.data.count)})}for(var l in i)isSocialCountPredefined(i[l])&&e("&"+i[l]+"="+getSocialPredefinedCount(i[l]))}function isSocialCountPredefined(t){return!!(_ain.social&&t in _ain.social)}function getSocialPredefinedCount(t){return isSocialCountPredefined(t)?_ain.social[t]:0}function getFromCookie(t){var e=t+"=",n=document.cookie.split(";"),i=0;for(i;i<n.length;i+=1){for(var a=n[i];" "===a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf(e))return a.substring(e.length,a.length)}return null}function prepareParam(t){return void 0!==t?encodeURIComponent(t):""}function getValidAdditionalOption(optionId){return optionId in _ain?-1==eval(optionId.toUpperCase()+"_DEFAULTS").indexOf(_ain[optionId])?(_ain.errors.push(_ain["E_INCORRECT_OPTION_"+optionId.toUpperCase()]),""):_ain[optionId]:""}function getBaseAdditionalOption(t){return t in _ain?_ain[t]:""}function createExpirationDate(t){var e=new Date;return e.setTime(e.getTime()+t),e.toGMTString()}function generateCID(){return(new Date).getTime()+"."+1e9*Math.random()}function getLink(t,e){var n=t.querySelector("link[rel='canonical']"),i=t.querySelector("meta[property='og:url']");return null!==n?n.getAttribute("href"):null!==i?i.getAttribute("content"):e||t.URL}function getCampaignData(){for(var t="",e=location.search.substr(1).split("&"),n=0;n<e.length;n++)"utm_"==e[n].substring(0,4)&&(t+="&"+e[n]);return t}function getCustomData(){var t="";if("data"in _ain)for(var e in _ain.data){var n=_ain.data[e];n="object"==typeof n?JSON.stringify(n):n,t+="&"+e+"="+prepareParam(n)}return t}function p(t){return-1==t.indexOf("://")&&(t=g.location.protocol+(0==t.indexOf("//")?"":"//")+t),t}function getText(t){if(isExcludedContent(t))return"";for(var e="",n=t.childNodes.length,i=0;i<n;i++){var a=t.childNodes[i];8==a.nodeType||isElementOnBlackList(a)||(e+=1!=a.nodeType?a.nodeValue:getText(a))}return e}function getTopmostElement(t){return t.reduce(function(t,e){return t.getBoundingClientRect().top>e.getBoundingClientRect().top?e:t})}function getBottommostElement(t){return t.reduce(function(t,e){return t.getBoundingClientRect().bottom<e.getBoundingClientRect().bottom?e:t})}function getMainContentPosition(t){var e=Math.max(document.documentElement.clientHeight,window.innerHeight||0),n=getTopmostElement(t),i=getBottommostElement(t),a=Math.abs(n.getBoundingClientRect().top-i.getBoundingClientRect().bottom),o=n.getBoundingClientRect().top,r=0;return r=Math.round(100*(e-o)/a),r>100?r=Math.abs(o)>=a?0:100:r<0&&(r=0),r}_ain.selectedText="";var elementsBlackList=["SCRIPT","STYLE","CANVAS","MAP","PICTURE","IMG","VIDEO","OBJECT","SVG","IFRAME"],OPTION_ACCESS_LEVEL="access_level",OPTION_ARTICLE_TYPE="article_type",OPTION_IMAGE="image",OPTION_READER_TYPE="reader_type",OPTION_EXCLUDE_CONTENT="excludecontent",ACCESS_LEVEL_DEFAULTS=["free","preview","paid"],READER_TYPE_DEFAULTS=["anonymous","registered","subscribed"];_ain.getWordCount=function(t){var e=parseInt(getBaseAdditionalOption("word_count"));return e&&e>0?e:(_ain.selectedText=t.filter(function(t){return!!t}).reduce(function(t,e){return t+=" "+getText(e)},""),_ain.selectedText.split(/\s+/).length)};var isElementOnBlackList=function(t){return-1!==elementsBlackList.indexOf(t.tagName)},isExcludedContent=function(t){var e=getBaseAdditionalOption(OPTION_EXCLUDE_CONTENT);if(!e)return!1;var n=Element.prototype;return(n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||function(t){return-1!==[].indexOf.call(document.querySelectorAll(t),this)}).call(t,e)};_ain.getMainContentEl=function(t){var e=t,n=[];if(!e){var i={5:'[data-url="'+j.url+'"] .post',1304:"#article .info",1285:".article__content",1298:"#detail",1321:"#d_conmment_holder"};e=i[did]?i[did]:"[data-ci-maincontent]"}if("function"!=typeof document.querySelector)return null;try{n=e.split(",").map(function(t){return document.querySelector(t)}).filter(function(t){return!!t})}catch(t){_ain.errors.push(_ain.E_INV_EL)}return n.length?n:null};var g=document,j=_ain,h=getFromCookie("_ain_cid"),f=getFromCookie("_ain_uid"),d=prepareParam(p(j.url||getLink(g))),did=prepareParam(j.id),pid=j.postid?"&pid="+prepareParam(j.postid):"1208"==did?"&pid="+prepareParam(getLink(g)):"",x=Math.random(),r=prepareParam(j.referrer||g.referrer),b="?a="+prepareParam(j.authors);if(b+="&b="+r,b+="&c="+prepareParam(j.title||g.title),b+="&d="+d,b+="&e="+prepareParam(j.sections),b+="&f="+did,b+="&g="+prepareParam(j.pubdate),b+="&h="+prepareParam(j.tags),b+="&i="+prepareParam(j.comments),b+="&j="+prepareParam(getValidAdditionalOption(OPTION_ACCESS_LEVEL)),b+="&k="+prepareParam(getBaseAdditionalOption(OPTION_ARTICLE_TYPE)),b+="&l=",b+="&m="+prepareParam(getValidAdditionalOption(OPTION_READER_TYPE)),b+=pid,j._mcel=!1,j._mcelwc=null,(null!==h||(g.cookie="_ain_cid="+generateCID()+"; expires="+createExpirationDate(18e5)+"; path=/",null!==(h=getFromCookie("_ain_cid"))))&&(null===f&&(f=generateCID()),g.cookie="_ain_uid="+f+"; expires="+createExpirationDate(63072e6)+"; path=/",null!==(f=getFromCookie("_ain_uid")))){if(b+="&u="+h,b+="&ul="+f,b+="&x="+x,b+=getCampaignData(),b+=getCustomData(),did){try{getSocial(prepareParam(p(j.social_url||j.url||g.URL)),function(t){b+=t})}catch(t){_ain.errors.push(_ain.E_NO_SOC)}var paramsPageViewEvent=b+"&t=0&err="+prepareParam(_ain.errors.join())+"&ver="+_ain.version;sendRequest(_ain.config.pv_url,paramsPageViewEvent),j._stid&&clearTimeout(j._stid),j._stid=setTimeout(function(){j._mcelwc=j._mcel?"&wc="+_ain.getWordCount(j._mcel):"";var t=b+j._mcelwc+"&t=1&err="+prepareParam(_ain.errors.join())+"&ver="+_ain.version;sendRequest(_ain.config.pv_url,t)},1e4)}!function(){window.visibly={q:document,p:void 0,prefixes:["webkit","ms","o","moz","khtml"],props:["VisibilityState","visibilitychange","Hidden"],m:["focus","blur"],visibleCallbacks:[],hiddenCallbacks:[],genericCallbacks:[],_callbacks:[],cachedPrefix:"",fn:null,onVisible:function(t){"function"==typeof t&&this.visibleCallbacks.push(t)},onHidden:function(t){"function"==typeof t&&this.hiddenCallbacks.push(t)},getPrefix:function(){if(!this.cachedPrefix)for(var t=0;bb=this.prefixes[t++];)if(bb+this.props[2]in this.q)return this.cachedPrefix=bb,this.cachedPrefix},visibilityState:function(){return this._getProp(0)},hidden:function(){return this._getProp(2)},visibilitychange:function(t){"function"==typeof t&&this.genericCallbacks.push(t);var e=this.genericCallbacks.length;if(e)if(this.cachedPrefix)for(;e--;)this.genericCallbacks[e].call(this,this.visibilityState());else for(;e--;)this.genericCallbacks[e].call(this,arguments[0])},isSupported:function(t){return this._getPropName(2)in this.q},_getPropName:function(t){return""==this.cachedPrefix?this.props[t].substring(0,1).toLowerCase()+this.props[t].substring(1):this.cachedPrefix+this.props[t]},_getProp:function(t){return this.q[this._getPropName(t)]},_execute:function(t){if(t){this._callbacks=1==t?this.visibleCallbacks:this.hiddenCallbacks;for(var e=this._callbacks.length;e--;)this._callbacks[e]()}},_visible:function(){window.visibly._execute(1),window.visibly.visibilitychange.call(window.visibly,"visible")},_hidden:function(){window.visibly._execute(2),window.visibly.visibilitychange.call(window.visibly,"hidden")},_nativeSwitch:function(){this[this._getProp(2)?"_hidden":"_visible"]()},_listen:function(){try{this.isSupported()?this.q.addEventListener(this._getPropName(1),function(){window.visibly._nativeSwitch.apply(window.visibly,arguments)},1):this.q.addEventListener?(window.addEventListener(this.m[0],this._visible,1),window.addEventListener(this.m[1],this._hidden,1)):this.q.attachEvent&&(this.q.attachEvent("onfocusin",this._visible),this.q.attachEvent("onfocusout",this._hidden))}catch(t){_ain.errors.push(_ain.E_LSTN)}},init:function(){this.getPrefix(),this._listen()}},this.visibly.init()}(),function(){_ain.atparams={d:d,did:did,pid:pid,h:h,f:f,x:x},_ain.atobj={secondsBetweenBeats:5.5,activeTimeout:5,sampleRateSeconds:.1,eventNames:["focus","mousedown","mouseup","mousemove","scroll","touchstart","touchenter","keyup","keydown"]};var t=(new Date).getTime();if(_ain.atobj._lastEvent=t,_ain.atobj._lastSample=t,_ain.atobj._engagedMs=0,_ain.atobj._engagedMsTotal=0,_ain.atobj.isEngaged=!0,_ain.atobj.isInteracting=!0,_ain.atobj.focused=!0,_ain.atobj.videoPlaying=!1,_ain.atobj.sequenceNum=1,window.visibly.onVisible(function(){_ain.atobj.focused=!0}),window.visibly.onHidden(function(){_ain.atobj.focused=!1}),void 0===_ain.atregisterEvent){var e=function(t,e){window.addEventListener?window.addEventListener(t,e,!1):document.attachEvent("on"+t,e)};_ain.atregisterEvent=function(){_ain.atobj._lastEvent=(new Date).getTime()};for(var n=0;n<_ain.atobj.eventNames.length;n++)e(_ain.atobj.eventNames[n],_ain.atregisterEvent);_ain.atsample=function(){var t=(new Date).getTime();_ain.atobj.isInteracting=t-_ain.atobj._lastEvent<1e3*_ain.atobj.activeTimeout,_ain.atobj.isEngaged=_ain.atobj.isInteracting&&_ain.atobj.focused||_ain.atobj.videoPlaying,_ain.atobj._engagedMs+=_ain.atobj.isEngaged?t-_ain.atobj._lastSample:0,_ain.atobj._lastSample=t},window.setInterval(_ain.atsample,1e3*_ain.atobj.sampleRateSeconds),_ain.atsendBeat=function(){!1===j._mcel&&(j._mcel=_ain.getMainContentEl(j.maincontent),j._mcel||_ain.errors.push(_ain.E_NO_EL));var t=Math.round(_ain.atobj._engagedMs/1e3);if(t>0&&t<=Math.round(_ain.atobj.secondsBetweenBeats)){_ain.atobj._engagedMsTotal+=t;var e="?d="+_ain.atparams.d+"&f="+_ain.atparams.did+_ain.atparams.pid+"&b="+r+"&u="+_ain.atparams.h+"&ul="+_ain.atparams.f+"&at="+_ain.atobj._engagedMsTotal+"&ar="+t+(j._mcel?"&sp="+getMainContentPosition(j._mcel):"")+"&ts="+Math.floor(Date.now()/1e3)+"&seq="+_ain.atobj.sequenceNum+++"&x="+_ain.atparams.x+"&err="+prepareParam(_ain.errors.join())+"&ver="+_ain.version;sendRequest(_ain.config.at_url,e)}_ain.atobj._engagedMs=0},window.setInterval(_ain.atsendBeat,1e3*_ain.atobj.secondsBetweenBeats),e("unload",_ain.atsendBeat)}}()}},"undefined"!==_ain.trackauto&&!1===_ain.trackauto||_ain.track();