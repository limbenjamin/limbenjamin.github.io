<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Benjamin Lim">
  <meta name="description" content="Attacks on public transportation tickets have been around for a number of years. Two Italian students were able to lock a single use ticket and...">

  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">  
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.8/css/bootstrap.min.css" type="text/css" media="all">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
  <link rel="stylesheet" href="../theme/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="../theme/css/pygments.css" type="text/css" media="all">
  
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.8/js/bootstrap.min.js"></script>

  <link rel="stylesheet" href="../theme/css/cookies-eu-banner.default.css" type="text/css" media="all">
  <script src="../theme/js/cookies-eu-banner.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
 

  <link href="https://limbenjamin.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="limbenjamin Full Atom Feed" />

<meta name="keywords" content="limbenjamin, Security">

<meta property="og:title" content="Pass the (EZ-Link Standard) ticket attack">
<meta property="og:type" content="website">
<meta property="og:image" content="http://limbenjamin.com/media/stdcard.jpg"/>
<meta property="og:image:secure_url" content="https://limbenjamin.com/media/stdcard.jpg"/>
<meta property="og:site_name" content="https://limbenjamin.com">
<meta property="og:description" content="Attacks on public transportation tickets have been around for a number of years. Two Italian students were able to lock a single use ticket and continually use it on the Turin public transit system. After reading through the research, I decided to try find out if Singapore&#39;s public transit fare …">
<meta property="og:url" content="https://limbenjamin.com/articles/pass-the-ez-link-standard-ticket-attack.html">
<meta property="fb:admins" content="557193263"/>
<meta property="fb:app_id" content="520142688161055"/>


  <title>Pass the (EZ-Link Standard) ticket attack</title>
  
</head>

<body class="home blog">
    <div id="cookies-eu-banner" style="display: none;position:fixed;bottom: 0">
        We use Google Analytics to analyze our traffic. By clicking "Accept", you consent to our use of cookies.
        <a href="../pages/privacy-policy-disclaimer.html" id="cookies-eu-more">Read more</a>
        <button id="cookies-eu-reject">Reject</button>
        <button id="cookies-eu-accept">Accept</button>
    </div>

  <div>
    <header class="site-header">
      <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse navbar-default" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item"><a class="nav-link" href="/index.html" >Index
<i class=" fa-lg"></i></a></li>
              <li class="nav-item"><a class="nav-link" href="/pages/about-me.html" >About me
<i class=" fa-lg"></i></a></li>
              <li class="nav-item"><a class="nav-link" href="/files/cv.html" >Résumé
<i class=" fa-lg"></i></a></li>
              <li class="nav-item"><a class="nav-link" href="/pages/projects.html" >Projects
<i class=" fa-lg"></i></a></li>
              <li class="nav-item"><a class="nav-link" href="/pages/reading-list.html" >Reading List
<i class=" fa-lg"></i></a></li>
            </ul>
            <div class="d-flex">
                <a class="nav-link" href="#mail" title="Email" >
<i class="fa-solid fa-envelope fa-lg"></i></a><div style="padding-right: 1em;"></div>
                <a class="nav-link" href="https://bugcrowd.com/h/limbenjamin" title="Bugcrowd" >
<i class="fa-brands fa-bimobject fa-lg"></i></a><div style="padding-right: 1em;"></div>
                <a class="nav-link" href="https://sg.linkedin.com/in/1imbenjamin" title="LinkedIn" >
<i class="fa-brands fa-linkedin fa-lg"></i></a><div style="padding-right: 1em;"></div>
                <a class="nav-link" href="https://github.com/limbenjamin" title="GitHub" >
<i class="fa-brands fa-github fa-lg"></i></a><div style="padding-right: 1em;"></div>
               <div class="oval">
                <center>
                  <img src="/files/nricspecimengen/merlion.png" class="merlion" style="height: 30px;"/>
                </center>
               </div> 
            </div>
          </div>
        </div>
      </nav>

    <div class="container">
      <div id="logo">
        <span class="site-name"><a class="navbar-brand" href=".."><svg width="240.45" height="194.71" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" enable-background="new 0 0 233.45 184.71" version="1.1">
  <ellipse ry="3.105" rx="3.583" cy="57.5" cx="60.225" fill="none" id="c1"/>
  <ellipse ry="3.167" rx="3.334" cy="103.258" cx="56.391" fill="none" id="c2"/>
  <ellipse ry="3.068" rx="3.25" cy="121.653" cx="99.809" fill="none" id="c3"/>
  <ellipse ry="2.831" rx="3.313" cy="124.92" cx="151.833" fill="none" id="c4"/>
  <ellipse ry="2.875" rx="3.794" cy="87.044" cx="172.48" fill="none" id="c5"/>
  <ellipse ry="3.074" rx="3.542" cy="41.134" cx="176.767" fill="none" id="c6"/>
  <ellipse ry="3.249" rx="3.375" cy="23.34" cx="132.85" fill="none" id="c7"/>
  <ellipse ry="3.406" rx="3.672" cy="19.792" cx="81.314" fill="none" id="c8"/>
  <path d="m86.488,57.958l9.25,-7.7c0,0 9.977,-3.196 11.063,-1.598c1.096,1.613 -6.785,7.035 -6.785,7.035s-8.215,7.563 -11.59,11.157c-0.757,0.806 -0.601,3.348 -0.188,4.357c0.308,0.75 1.822,2.553 2.434,2.143c7.625,-5.123 21.754,-18.407 21.754,-18.407l9.375,-5c0,0 7.036,-1.207 7.624,0.313c0.007,0.019 -39.499,32.375 -40.124,34.438c0,0 0.472,3.652 1.161,4.625c0.232,0.328 0.76,3.303 1.714,3.5c2.615,0.54 41.904,-37.551 45.609,-40.625c0,0 3.646,-0.722 4.641,-0.125c0.899,0.539 1.913,2.703 1.875,3.75c-0.031,0.87 -0.575,2.7 -1.25,3.25c-10.325,8.41 -38.067,33.125 -38.067,33.125s-1.816,1.791 -1.599,2.5c0.341,1.113 3.112,1.837 4.276,1.848c1.466,0.014 4.601,-0.106 5.784,-0.973c7.718,-5.651 19.644,-24.073 29.106,-24.201c0.557,-0.007 1.75,1.377 1.75,1.377s0.585,1.006 0.625,1.384c0.108,1.028 -0.875,4.041 -0.875,4.041s-19.225,11.634 -17.252,17.442c0.41,1.207 4.771,0.65 5.012,0.93c0.24,0.277 4.615,-1.223 4.615,-1.223l5.344,-4.5l4.737,-4" stroke-miterlimit="10" stroke-width="12" stroke="#C4E6FC" fill="#FFFFFF" id="path4"/>
  <polyline points="  113.85,84.855 107.335,85.995 104.659,78.331 102.547,77.518 113.85,76.792 102.09,66.755 115.057,69.085 108.215,63.024   116.101,63.73 109.095,59.23 112.126,59.264 116.839,61.185 123.1,59.48 124.538,63.917 130.1,67.012 121.1,69.605 127.922,70.98   120.35,75.105 129.099,76.855 130.1,79.567 123.85,79.567 119.85,80.552 120.225,84.73 123.35,86.56 126.725,84.169 " stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="9" stroke="#0e94ec" fill="none" id="path3"/>
  <path id="svg_1" d="m64.398,138.725l0,4.952l0.003,7.07c0,1.25 -0.006,2.441 0,3.641c0.033,4.984 2.112,7.248 7.056,7.686c4.865,0.43 8.695,-1.662 9.335,-5.646c0.751,-4.694 -0.662,-7.678 -6.401,-9.198c-0.768,-0.204 -7.782,2.034 -7.782,2.034" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <path id="svg_2" d="m154.386,162.585c-0.955,-3.899 1.028,-7.91 -0.943,-12.09c-2.598,-2.188 -6.129,-3.965 -10.206,-3.188c-4.703,0.901 -7.265,6.345 -5.324,10.155c2.08,4.076 7.945,6.084 12.321,4.052c1.17,-0.541 1.988,-1.66 2.968,-2.515" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <path id="svg_3" d="m116.155,15c1.354,9.719 0.215,19.476 0.588,29.21" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_4" d="m116.744,100.58c-0.373,9.732 0.764,19.492 -0.588,29.209" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_5" d="m182.616,72.394c-11.176,0 -22.349,0 -33.523,0" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_6" d="m84.398,72.394c-10.784,0 -21.564,0 -32.348,0" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_7" d="m131.45,147.212c0,5.639 -0.09,11.274 0.033,16.91c0.083,4.088 -2.047,5.527 -6.502,4.611" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <path id="svg_8" d="m101.455,159.511c-6.208,3.932 -9.051,3.632 -14.408,-1.273c0,-2.313 0,-4.361 0,-6.975c2.083,-2.984 5.484,-5.039 10.278,-3.986c3.69,0.807 5.556,3.291 6.199,7.074c-5.29,1.102 -10.488,0.303 -15.592,0.55" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <path id="svg_9" d="m6.21952,140.041c0,7.515 0,15.031 0,22.547" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <path id="svg_10" d="m84.398,86.743c-6.012,-0.712 -10.977,0.583 -14.762,5.087c-2.83,3.363 -7.351,5.351 -10.211,8.649c0.588,2.819 0.697,5.351 -3.075,6.364c-3.519,-2.264 -3.519,-2.264 -3.115,-5.818c1.595,-1.4 3.375,-1.428 5.286,-0.445" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_11" d="m133.213,100.58c0,2.623 0,5.246 -0.004,7.875c4.597,4.959 10.233,9.064 15.309,13.637" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_12" d="m174.383,44.208c3.436,0.787 3.436,0.787 6.468,-2.562c-0.608,-1.282 -0.624,-2.858 -3.047,-3.586c-4.478,0 -5.527,1.258 -3.871,6.031c-3.858,3.361 -8.056,6.728 -11.854,10.407c-3.861,3.743 -8.399,4.227 -13.562,3.055" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_13" d="m84.986,23.198c2.744,2.391 5.183,5.16 8.3,7.092c5.843,3.616 7.154,8.463 6.401,14.173" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_14" d="m84.986,48.82c-0.588,10.036 0.342,19.475 0.566,29.21c0.114,4.953 -0.174,9.914 0.08,14.858c0.22,4.17 3.167,6.432 8.766,6.611c7.047,0.224 14.113,0.096 21.169,0.037c8.628,-0.074 17.284,0.809 25.877,-0.496" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_15" d="m109.687,162.585c0,-2.221 0,-4.439 0,-6.66c0.01,-6.356 0.495,-6.943 7.445,-9.161c6.228,0.582 7.774,3.911 7.3,8.651c-0.234,2.371 -0.039,4.779 -0.039,7.17" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <path id="svg_16" d="m84.398,22.686c0.094,-1.708 1.471,-3.416 -0.278,-5.487c-2.764,-1.521 -5.084,-0.901 -6.9,1.812c0.652,3.505 2.523,5.095 6.59,3.673" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_17" d="m174.971,150.287c2.492,-2.002 4.857,-4.226 8.822,-3.084c4.674,1.34 5.258,4.693 5.254,8.211c-0.002,2.389 0.606,4.842 -0.549,7.174" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <path id="svg_18" d="m34.44852,150.287c2.493,-2.002 4.857,-4.226 8.827,-3.084c4.668,1.34 5.252,4.693 5.248,8.211c-0.003,2.389 0.607,4.842 -0.546,7.174" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <path id="svg_19" d="m213.4196,149.774c2.207,-2.112 5.209,-2.614 8.254,-3.103c8.74,3.414 5.027,10.307 5.857,15.914" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <path id="svg_20" d="m99.69,100.58c0,5.637 0,11.272 0,16.912" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_21" d="m133.213,27.298c-1.881,-0.508 -3.342,-1.443 -4.109,-2.874c-0.1,-2.687 1.302,-4.029 4.438,-4.333c2.396,0.05 2.793,2.094 3.918,3.829c-4.814,2.417 -4.404,6.499 -4.268,10.554c0.104,3.242 0.021,6.49 0.021,9.735" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_22" d="m64.402,58.044c-0.883,1.521 -1.574,3.237 -3.116,3.136c-3.723,-0.083 -4.121,-2.127 -5.114,-3.649c1.295,-1.098 2.163,-2.639 4.11,-3.077c0.395,-0.168 0.751,0.028 1.186,0.512c3.428,3.839 8.307,3.059 12.934,3.077c3.333,0.012 6.665,0.001 9.997,0.001" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_23" d="m90.136,47.008c0,0 2.689,-0.821 3.627,-0.94c11.372,-1.441 45.966,0 45.966,0s4.704,0 7.057,4.782c1.517,3.084 0.588,13.409 0.588,13.409c0.265,5.628 0.554,16.847 0.364,25.155c-0.093,4.119 -0.438,7.302 -1.405,8.216" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_24" d="m195.552,147.212c0,5.127 0,10.25 0,15.373" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <path id="svg_25" d="m13.27652,147.212c0.344,5.119 -0.708,10.274 0.588,15.373" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <path id="svg_26" d="m106.159,81.616c-3.056,-0.271 -4.508,1.58 -3.953,3.553c0.731,2.573 2.314,5.031 6.302,5.219c3.143,0.146 5.415,-1.054 7.647,-2.621" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_27" d="m130.862,73.418c4.986,3.416 5.739,6.659 1.65,9.618c-1.395,1.002 -1.908,1.735 -2.323,3.169c-1.147,3.923 -4.836,4.559 -8.726,4.07c-4.215,-0.536 -5.494,-3.068 -5.353,-6.61c0.229,-5.807 -0.211,-11.636 0.637,-17.421" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_28" d="m121.454,62.143c2.06,0.083 4.098,0.096 5.992,-1.22c1.021,-1.794 0.502,-3.646 -0.699,-5.443c-3.627,-1.815 -6.957,-1.447 -10,1.025" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_29" d="m127.922,61.118c8.213,3.333 9.129,5.962 4.115,11.788" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_30" d="m172.62,83.666c4.885,2.153 4.885,3.512 -0.062,6.698c-2.347,-0.014 -2.901,-1.871 -4.136,-3.198c0.043,-0.208 1.363,-3.349 3.607,-3.502" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_31" d="m116.155,60.094c1.411,-4.141 -1.359,-5.608 -5.292,-5.556c-4.228,0.051 -7.223,1.621 -5.881,6.068" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_32" d="m34.44852,162.585c0,-2.731 -0.109,-5.471 0.033,-8.197c0.15,-2.819 -0.218,-5.359 -3.564,-6.646c-3.108,-1.195 -5.96,-1.09 -8.264,1.5c-0.573,0.648 -1.568,1.002 -2.418,1.522c0.503,3.956 -0.583,7.937 0.687,11.821" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <path id="svg_33" d="m174.971,162.585c0,-2.731 -0.11,-5.471 0.033,-8.197c0.146,-2.819 -0.223,-5.359 -3.567,-6.646c-3.104,-1.195 -5.958,-1.09 -8.261,1.5c-0.576,0.648 -1.571,1.002 -2.42,1.522c0.5,3.956 -0.582,7.937 0.687,11.821" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <path id="svg_34" d="m212.2416,147.212c0.781,5.127 1.078,10.25 0,15.373" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <path id="svg_35" d="m107.923,100.58c-0.31,3.24 0.652,6.539 -0.588,9.735" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_36" d="m124.981,34.472c0,3.245 0,6.49 0,9.737" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_37" d="m84.398,65.217c-3.724,0 -7.448,0 -11.176,0" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_38" d="m84.398,79.567c-3.724,0 -7.448,0 -11.176,0" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_39" d="m108.511,34.472c-0.799,3.304 -0.542,6.656 -0.588,9.992" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_40" d="m99.102,118.003c-3.216,1.107 -3.561,3.125 -2.557,5.438c1.783,1.822 3.631,1.311 5.78,0.813c1.336,-2.635 2.114,-4.98 -2.047,-6.248" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_41" d="m106.159,61.118c-8.909,2.108 -10.495,5.153 -5.88,11.275" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_42" d="m124.981,100.58c0,2.563 0,5.125 0,7.687" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_43" d="m147.929,80.552" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_44" d="m103.807,71.369c-7.492,3.443 -8.061,7.403 -1.764,12.297" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_45" d="m150.27,122.102c-3.477,3.047 -3.451,3.165 1.177,6.151c3.031,0.246 3.632,-1.625 4.173,-3.328c-0.158,-3.161 -2.578,-2.825 -4.762,-2.823" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_46" d="m152.141,64.778" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <line id="svg_47" y2="65.217" x2="160.633" y1="65.217" x1="149.094" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <line id="svg_48" y2="80.552" x2="160.633" y1="80.552" x1="149.657" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <line id="svg_49" y2="86.56" x2="149.657" y1="86.56" x1="168.686" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <path id="svg_50" d="m72.103,149.261" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path"/>
  <line id="svg_51" y2="142.605" x2="13.19652" y1="144.105" x1="13.19652" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <line id="svg_52" y2="142.605" x2="131.485" y1="144.105" x1="131.485" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <line id="svg_53" y2="142.605" x2="195.552" y1="144.105" x1="195.552" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path2"/>
  <path id="svg_55" d="m207.94637,139.60637c-5.07042,8.50889 -4.78873,20.67334 -0.28169,27.76737" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path-math"/>
  <path id="svg_56" d="m231.23797,139.04299c5.51383,8.33153 5.89985,21.62274 0,29.7392" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path-math"/>
  <path id="svg_58" d="m5.31949,173.66319c0.88282,-1.05133 2.26613,-2.2136 3.48416,-2.45702c3.49609,1.69944 2.01085,5.13069 2.34286,7.92178" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path-math"/>
  <path id="svg_59" d="m4.69434,171.12152c0.56044,3.03516 0.03595,5.5208 0,8.00644" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path-math"/>
  <path id="svg_61" d="m31.38249,174.40239c-5.93517,0.3131 -10.72478,0.16138 -15.944,0.29293" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path-math"/>
  <path id="svg_63" d="m32.69496,173.37413c-1.90726,-1.13322 -2.9091,-2.36138 -4.5109,-3.8134" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path-math"/>
  <path id="svg_64" d="m27.1541,179.70653c2.55509,-1.52525 3.89723,-3.1783 6.04311,-5.13265" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path-math"/>
  <path id="svg_65" d="m57.57433,174.40159c-1.96966,4.78764 -6.15864,4.57019 -8.34568,1.90093c-2.18704,-2.66926 -4.93737,-5.23437 -8.36945,-4.68439c-3.95906,0.63775 -3.56744,3.74256 -0.03956,5.8806c3.52788,2.13804 8.49863,-4.21932 9.92778,-5.7228c1.42915,-1.50348 5.26908,-1.14241 6.94077,2.70204" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000000" fill="none" class="path-math"/>
</svg></a>
        </span><!-- end of .site-name -->
      </div><!-- end of #logo -->
        <div class="tagline">
                <a href="../tag/coding.html" >Coding (13)</a> &#124; 
                <a href="../tag/data.html" >Data (25)</a> &#124; 
                <a href="../tag/legal.html" >Legal (41)</a> &#124; 
                <a href="../tag/nus.html" >NUS (3)</a> &#124; 
                <a href="../tag/security.html" >Security (123)</a> &#124; 
                <a href="../tag/server.html" >Server (32)</a> &#124; 
                <a href="../tag/untagged.html" >Untagged (20)</a> &#124; 
                <a href="../archives.html" >Archives (218)</a>
        </div>
    </div>

  </header><!-- #masthead -->
  </div>
    <div id="content" class="site-content">
      <div class="container main-content-area">
        <div class="row">
          <div class="main-content-inner col-sm-12 col-md-12">
            <div id="primary" class="content-area">
              <div id="main" class="site-main" role="main">
                <div class="article-container">
<article>
  <div class="blog-item-wrap">
    <div class="post-inner-content">
      <header class="entry-header page-header">
        <span class="cat-item"><time datetime="2016-06-26 11:13:00+08:00">Jun 26, 2016</time></span>
        <h1 class="entry-title-single-page"><a href="../articles/pass-the-ez-link-standard-ticket-attack.html">Pass the (EZ-Link Standard) ticket attack</a></h1>
      </header><!-- .entry-header -->
      <div class="entry-content">
        <p>Attacks on public transportation tickets have been around for a number of years. Two Italian students were able to <a href="http://mashable.com/2013/08/05/mifare-ultralights-hack-def-con/#rRkZel_tzuqP">lock a single use ticket</a> and continually use it on the Turin public transit system. After reading through the research, I decided to try find out if Singapore's public transit fare system is vulnerable to a similar exploit. </p>
<p>The EZ-Link standard ticket is a single use ticket for the MRT system in Singapore. The standard ticket is only valid for a single day. However, commuters can get a refund for their unused tickets from any passenger service centre within 3 days of purchase of the ticket. In an effort to reduce wastage, the single ticket can also be topped up and used for up to 6 trips within 30 days. </p>
<p>Upon scanning the standard ticket with an NFC reader, I discovered that the card used is Mifare Ultralight, which is same as that used in the Turin system. Mifare Ultralight does not support any form of encryption or access control, hence it is possible to obtain a card dump.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code>13 Jun 2016     $1.50 Stored Value

05 31 13 af     ID
e9 54 b0 c1     ID + Chk Digit
cc 01 0f 80     Chk Digit + Lock (0f 80) = (0000 1111 1000 0000)
00 4f 24 00     OTP  (Locked Permanently)
b9 77 6a 5c     Prog (Unlocked Permanently)
73 fc e9 78     Prog (Unlocked Permanently)
72 a1 32 16     Prog (Unlocked Permanently)
48 08 76 89     Prog (Unlocked Permanently)
b0 f9 db 2f     Prog (Unlocked Permanently)
00 00 00 00     Prog (Unlocked Permanently)
d9 71 b1 75     Prog (Unlocked Permanently)
37 93 ec a2     Prog (Unlocked Permanently)
0e 71 09 75     Prog (Unlocked Permanently)
c6 e4 76 4f     Prog (Unlocked Permanently)
06 07 01 c4     Prog (Unlocked Permanently)
17 f9 4a c2     Prog (Locked Permanently)
</code></pre></div></td></tr></table></div>

<p>Upon consulting the <a href="http://www.nxp.com/documents/data_sheet/MF0ICU1.pdf">Mifare Ultralight specifications</a>, I realised that the standard ticket worked differently from the Turin system. The attack on the Turin system involved locking the bits in the OTP page so they cannot be turned on or off, however the OTP page on the standard ticket was already permanently locked. Hence, the EZ-Link system must rely on a different method. At a cursory glance, I was unable to find the date of purchase, 13 June, nor the $1.50 stored value anywhere on the card. I needed more samples so I decided to acquire a second card and dump both cards in new and spent state.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code>Card #1         Card #1         Card #2         Card #2
13 Jun 2016     13 Jun 2016     14 Jun 2016     14 Jun 2016 
$1.50 value     $0 value        $1.50 value     $0 value

05 31 13 af     05 31 13 af     05 31 23 9f     05 31 23 9f
e9 54 b0 c1     e9 54 b0 c1     e9 54 b0 c1     e9 54 b0 c1
cc 01 0f 80     cc 01 0f 80     cc 01 0f 80     cc 01 0f 80
00 4f 24 00     00 4f 24 00     00 4f 24 00     00 4f 24 00
b9 77 6a 5c     b9 77 6a 5c     8d b3 8e d2     8d b3 8e d2
73 fc e9 78     73 fc e9 78     23 67 68 ac     23 67 68 ac
72 a1 32 16     72 a1 32 16     26 76 57 81     26 76 57 81
48 08 76 89     48 08 76 89     4e d6 94 5a     4e d6 94 5a
b0 f9 db 2f     b0 f9 db 2f     a7 51 bc 69     a7 51 bc 69
00 00 00 00     00 00 00 00     00 00 00 00     00 00 00 00
d9 71 b1 75     31 43 ed bd     fb 18 b0 4f     85 25 2a 49
37 93 ec a2     8c 15 12 9a     ad c5 bc 73     02 be 65 0a
0e 71 09 75     c9 89 bf 66     37 f1 11 88     6e 37 ca fc
c6 e4 76 4f     92 1e 89 cf     18 13 18 34     38 00 f1 45
06 07 01 c4     ce 66 38 60     6a 91 99 a1     36 c6 36 4f
17 f9 4a c2     17 f9 4a c2     17 f9 4b 58     17 f9 4b 58
</code></pre></div></td></tr></table></div>

<p>I wanted tickets that differed in only 1 attribute, in this case, the date, so I could identify which bits were flipped, which would indicate the page where the date was stored. The tickets were bought from the same dispensing machine, hence the similar ID numbers.</p>
<p>Comparing the dumps, it became obvious that page 10 to 14 (Line 14-18) is used to store the data. However, a difference in only 1 attribute resulted in a significant difference in data. 13 June looked completely different from 14 June. $1.50 looked completely different from $0. In other words, the cipher used exhibited very good diffusion properties.</p>
<h2>XOR cipher</h2>
<p>We will start with the low hanging fruit first, the XOR cipher. When the key of the XOR cipher is as long as the plaintext, we get a one time pad which exhibits good randomness. The card ID, OTP and the last page is ruled out because they are too similar, hence given that the plaintext is similar, they will produce similar looking ciphertexts. The only candidate key is page 4 to 8 (Line 8-12). It is 160 bits long, exactly the same length as the plaintext and card #1 has a very different value compared to card #2. Unfortunately, the XORed result did not display any correlation.</p>
<h2>3DES cipher</h2>
<p>Moving on, I realised that the card UID is exactly 56 bits, which is the effective keysize for DES. Using a <a href="https://limbenjamin.com/articles/des-key-parity-bit-calculator.html">script which I wrote</a>, I expanded the key and used it to perform both DES-CBC and 3DES-CBC(DDD) decryption. DED is the preferred mode, most likely used in CEPAS as well, but with only 1 key, DED mode would be equivalent to DES. The results were similarly unspectacular.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code>Key - 05 31 13 af e9 54 b0
04984575FE4A5261

1DES-CBC:       ED04580528C2727E2507E6A8FC0AD3BB38DD70B0E4115845
1DES-CBC:       8515F7490415442ECB0E5FD018E89707E8AB7777B58428D9
3DES-CBC(DDD):  A5B101675604C88EA88C2F92924255FE8A8785E5A9809AA1
3DES-CBC(DDD):  DFBE27CCD05FEC12ACBBC8A1E01B4993CB52FCD524C1E356

Key - 05 31 23 9f e9 54 b0
04984973FE4A5261

1DES-CBC:       15F8DF2BD07494352E227B79DE46F42F0A1FD09E9F6ADAAC
1DES-CBC:       8A94E0E2D3964DF11864D116F1E1681977BBF528C273730F
3DES-CBC(DDD):  3D2DE1CDB79C78824EB8039B167D63E7A528F17F84C39525
3DES-CBC(DDD):  D8280E566E42A68C874074F21E9C01C928B7DC1ADE53A725
</code></pre></div></td></tr></table></div>

<p>Time for more research. NXP publishes <a href="http://www.nxp.com/documents/application_note/AN073121.pdf">a document</a> which provides implementation "hints". One of the tips include the use of a 128 bit Master Key which is encrypted with the card UID to produce 3 card keys which is used for 3DES(DED) decryption. The document also describes the use of zero padding and a default IV of 0s. In a last ditch attempt, I decided to follow the "hints" as closely as possible. Since I did not have a Master Key, I zero padded page 4 to 8 and used it in place of the Master Key. No dice. Looks like the crypto is sound.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code>1DES-Enc(page 4-8): 7FB935FB60863D01 2FB080C66B00A5C6 9FB477A1C76B7543
3DES-Composite Key(DDD): 38FF80ADD7F5EE25715C151621A84253C44BCC6913C91C9F
3DES-Composite Key(DDD): E14EAE79EB8CBBC6AEB01078209F02153C84C66C56DC3D03

1DES-Enc(page 4-8): DAA7FD0D0E86CC1D 716A6CE00E13AAE3 0EC20A1433D41899
3DES-Composite Key(DDD): 12354C9493AF218598B9DFD185E76A51E4A9CB5E0E2AACC6
3DES-Composite Key(DDD): 7256341BCF51E70346D58D2E07ED17E1C182049F4178D2CC
</code></pre></div></td></tr></table></div>

<h2>Pass the (EZ-Link Standard) ticket attack</h2>
<p>The pass-the-ticket attack is based off the pass-the-hash attack, the idea being that if you cannot crack the hash, you simply forge a request and include the hash within. It is perfect for use with the Mifare Ultralight because the card does not contain a chip. It cannot perform a challenge response, or include a unique nonce or timestamp for each request. Therefore, it is trivial to perform a replay attack. In order to exploit the system, dump page 10 to 14 into a file. Go up to the passenger service centre and ask for a refund. Once out of sight, clone page 10 to 14 back onto the card. Go and ask for another refund at a different counter. Profit. </p>
<p>With more than 100 MRT stations in Singapore, there is more than enough to rotate around. A single card with round trip fare can store up to $6+, assuming you refund 3 card per station (to avoid suspicion), it is $18/station. Assuming you can visit 5 stations in an hour, it is a cool $90/hour in cash. Some stations have multiple centres due to multiple exits or it being an interchange with multiple lines. Further Profit. Don't forget, you also get to travel for free by reloading a 4th card and using it for personal travel.</p>
<p>The only equipment required is an Android phone with an NXP NFC chipset. A list of compatible phones has been provided <a href="http://nfc.today/nfc-enabled-phones">here</a>. There are many apps out there which allow reading and writing to Mifare Ultralight cards.</p>
<h2>Proof</h2>
<p><img alt="proof" src="//limbenjamin.com/media/stdcard1.jpg"></p>
<h2>EZ-Link Golden Ticket</h2>
<p>Inspired by the Kerberos golden ticket, a hypothetical EZ-Link golden ticket would allow unlimited travel for free. The cipher will first need to be broken, so it is impossible as of now. You will then need to get hold of a blank Mifare Ultralight card. Write in the data as necessary. Lock page 10 to 14. The card can now be used for free for today. For tomorrow, unlock pages 10 to 14, write in new data, and relock the pages. Make sure not to lock the block locking bits or you will not be able to unlock the pages anymore. For convenience, an app could perform the necessary computation, unlocking and relocking at the touch of a button. This is assuming the reader at the gantry does not verify the state of the locking bits.</p>
<h2>Conclusion</h2>
<p>While the EZ-Link standard ticket is not vulnerable to a golden ticket attack as was the case in the Turin exploit, it is vulnerable to a pass-the-ticket attack. The pass-the-ticket attack is usually less severe than the golden ticket attack. However, in this particular case, EZ-Link allows for the refund of the tickets. This increases the severity of the attack since attackers can now extract cash from the system, cash that can be spent not only on transportation, but on food, entertainment or elsewhere. </p>
      </div><!-- .entry-content -->
      <br /><br />
      <div class="article_meta">
        Tags:
          <a href="../tag/security.html">Security</a>        <br />
        <div class="similararticleline"></div>
        <h2>Similar Articles</h2>
          <div class="similararticlerow">
              <blockquote class="similar_posts">
              <a href="../articles/on-physical-authentication.html"><b>On Physical Authentication - </b>
              Recently, I moved into a new environment and had the opportunity to witness a number of processes. This experience further reinforced in me the importance of policies over technical measures. ...</a>
              </blockquote>
              <blockquote class="similar_posts">
              <a href="../articles/flare-on-6-solve-vv-max-by-hand.html"><b>FLARE-On 6 - Solve vv_max by hand - </b>
              After looking at the published solutions for FLARE-On 6, I realised that for challenge 11, vv_max, most people used a script to either reverse the AVX functions or to brute force it. My approach ...</a>
              </blockquote>
              <blockquote class="similar_posts">
              <a href="../articles/tips-for-winning-sans-ctfs.html"><b>Tips for winning SANS CTFs - </b>
              Over the past 3 years, I have attended 3 SANS courses and participated in 3 NetWars events. I have won the challenge coin for every event I participated in. I hope this gives a bit more ...</a>
              </blockquote>
              <blockquote class="similar_posts">
              <a href="../articles/dumping-aztech-DSL1015EN-firmware.html"><b>Dumping Aztech DSL1015EN firmware - </b>
              Recently, I had the fortune to come across a spare DSL1015EN router cum modem. After dismantling the external case, this is what the internals look like. On the left, we can see 2 u.fl connectors ...</a>
              </blockquote>
          </div>
      </div>
      <br />
    </div>
  </div>
</article><!-- #post-## -->
                </div>
              </div><!-- #main -->
          </div><!-- #primary -->
        </div>
      </div><!-- close .row -->
    </div><!-- close .container -->
  </div><!-- close .site-content -->

  <div id="mail" class="overlay">
    <div class="popup">
      <a class="close" href="#">&times;</a>
      <div id="popup_content">
      </div>
    </div>
  </div>

  <div id="footer-area">
    <footer id="colophon" class="site-footer" role="contentinfo">
      <div class="site-info container">
        <div class="row">
                    <div class="copyright col-md-12">
                    <a href="../pages/privacy-policy-disclaimer.html">Privacy & Disclaimer</a> | 
                    <a href="../feeds/all.atom.xml">Atom Feed</a> | 
                    <a href="../sitemap.xml">Sitemap</a><br />
                    This site uses the <a href="https://github.com/limbenjamin/voce">voce</a> theme by <a href="//limbenjamin.com/">Benjamin Lim</a><br />
                    Page generated on Sun Jan 11 09:47:10 2026<br />
                    &copy; 2012-2026 <a href="..">Benjamin Lim</a> </div>
        </div>
      </div><!-- .site-info -->
      <div class="scroll-to-top" style="display: none;"><i class="fa-solid fa-angle-up"></i></div><!-- .scroll-to-top -->
      <div class="dark-mode" style="display: block;"><i class="fa-solid fa-moon"></i></div><!-- .dark-mode -->
    </footer><!-- #colophon -->
  </div>

  <script>
    const darkmode =  new Darkmode();  
  </script>
  <script type="text/javascript">
    window.addEventListener('load', function(){    
    if (window.location.pathname != '/' && window.location.pathname != '/index.html'){
      window.scroll(0, document.getElementById('main').offsetTop);
    }})
  </script>


  <script type="text/javascript" src="../theme/js/functions.min.js"></script>




<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-028MBYWX6K"></script>
<script>
 new CookiesEuBanner(function () {
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'G-028MBYWX6K');
  }, true);
</script>
  
</body>
</html>