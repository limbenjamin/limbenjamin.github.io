<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Benjamin Lim">
  <meta name="description" content="The quiz in question. In case anyone is not familiar with it. (attractive?) prizes to be won. A quick packet capture revealed that the questions could...">

  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">  
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" type="text/css" media="all">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="../theme/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="../theme/css/pygments.css" type="text/css" media="all">
  
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js"></script>


  
 

  <link href="https://limbenjamin.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="limbenjamin Full Atom Feed" />

<meta name="keywords" content="limbenjamin, Security">

<meta property="og:title" content="How I (cheated and) won a quiz">
<meta property="og:type" content="website">
<meta property="og:image" content="http://limbenjamin.com/media/code.png">
<meta property="og:image:secure_url" content="https://limbenjamin.com/media/code.png">
<meta property="og:site_name" content="https://limbenjamin.com">
<meta property="og:description" content="The quiz in question. In case anyone is not familiar with it. (attractive?) prizes to be won. A quick packet capture revealed that the questions could be found here in JSON format. This is what is looked like. Interesting that the answers were included even through &#34;marking&#34; was done only …">
<meta property="og:url" content="https://limbenjamin.com/articles/how-i-cheated-and-won-a-quiz.html">
<meta property="fb:admins" content="557193263"/>
<meta property="fb:app_id" content="520142688161055"/>


  <title>How I (cheated and) won a quiz</title>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40858819-1', 'auto');
  ga('send', 'pageview');

</script>
  
</head>

<body class="home blog">
  <div>
    <header class="site-header">
      <nav class="navbar navbar-default" role="navigation">
        <div class="container">
          <div class="row">
            <div class="site-navigation-inner col-sm-12">
              <div class="navbar-header">
                <button type="button" class="btn navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
              </div>
              <div class="collapse navbar-collapse navbar-ex1-collapse">
              <ul id="menu-all-pages" class="nav navbar-nav">
                <li class="menu-item"><a href="/index.html" >Index
<i class="fa  fa-lg"></i></a></li>
                <li class="menu-item"><a href="/pages/about-me.html" >About me
<i class="fa  fa-lg"></i></a></li>
                <li class="menu-item"><a href="/files/cv.html" >Résumé
<i class="fa  fa-lg"></i></a></li>
                <li class="menu-item"><a href="/gpg.txt" >GPG Key
<i class="fa  fa-lg"></i></a></li>
                <li class="menu-item"><a href="/pages/projects.html" >Projects
<i class="fa  fa-lg"></i></a></li>
              </ul>
              </div>
              <div class="social">   
                <a href="https://limbenjamin.com/feeds/all.atom.xml" title="Feed" >
<i class="fa fa-rss fa-lg"></i></a>
                <a href="#mail" title="Email" >
<i class="fa fa-envelope fa-lg"></i></a>
                <a href="https://sg.linkedin.com/in/1imbenjamin" title="LinkedIn" >
<i class="fa fa-linkedin fa-lg"></i></a>
                <a href="https://github.com/limbenjamin" title="GitHub" >
<i class="fa fa-github fa-lg"></i></a>
                <a href="https://security.stackexchange.com/users/53583/limbenjamin" title="StackExchange" >
<i class="fa fa-stack-exchange fa-lg"></i></a>
              </div>
            </div>
          </div>
        </div>
      </nav><!-- .site-navigation -->

    <div class="container">
      <div id="logo">
        <span class="site-name"><a class="navbar-brand" href=".."><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"   width="233.45px" height="184.71px" viewBox="0 0 233.45 184.71" enable-background="new 0 0 233.45 184.71" xml:space="preserve"><ellipse id="c1" fill="none" cx="60.2" cy="57.5" rx="3.6" ry="3.1"/><ellipse id="c2" fill="none" cx="56.4" cy="103.3" rx="3.3" ry="3.2"/><ellipse id="c3" fill="none" cx="99.8" cy="121.7" rx="3.3" ry="3.1"/><ellipse id="c4" fill="none" cx="151.8" cy="124.9" rx="3.3" ry="2.8"/><ellipse id="c5" fill="none" cx="172.5" cy="87" rx="3.8" ry="2.9"/><ellipse id="c6" fill="none" cx="176.8" cy="41.1" rx="3.5" ry="3.1"/><ellipse id="c7" fill="none" cx="132.8" cy="23.3" rx="3.4" ry="3.2"/><ellipse id="c8" fill="none" cx="81.3" cy="19.8" rx="3.7" ry="3.4"/><path id="path4" fill="#FFF" stroke="#C4E6FC" stroke-width="12" stroke-miterlimit="10" d="M86 58l10-8s10-3 11-1c1 1-7 7-7 7L88 67v4c1 1 2 3 3 2l21-18 10-5h7L89 85l1 4 2 4c3 0 42-38 46-41h4l2 4-1 3-38 33-2 3 5 2 5-1c8-6 20-25 30-25l1 2 1 1-1 4s-19 12-17 18l5 1 4-2 6-4 5-4"/>    <path id="path3" fill="none" stroke="#0e94ec" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M114 85l-7 1-2-8h-2l11-1-12-10 13 2-7-6 8 1-7-5h3l5 2 6-2 2 5 5 3-9 3 7 1-8 4 9 2 1 3h-6l-4 1v4l3 2 4-3"/><path class="path2" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M64 139v15c0 5 3 8 7 8 5 1 9-2 10-6s-1-7-7-9l-7 2M154 163c-1-4 1-8-1-13-2-2-6-3-10-3-4 1-7 7-5 10 2 5 8 7 12 5l3-3"/><path class="path" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M116 15c2 10 0 19 1 29M117 101c-1 9 1 19-1 29M183 72h-34M84 72H52"/><path class="path2" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M131 147v17c1 4-2 6-6 5M101 160c-6 3-9 3-14-2v-7c2-3 6-5 10-4s6 4 7 7l-16 1M15 140v23"/><path class="path" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M84 87c-6-1-11 0-14 5l-11 8c1 3 1 6-3 7-3-2-3-2-3-6h6M133 101v7l16 14M174 44c4 1 4 1 7-2l-3-4c-5 0-6 1-4 6l-12 10c-4 4-8 5-13 4M85 23l8 7c6 4 7 9 7 14M85 49c-1 10 0 19 1 29v15c0 4 3 6 8 6l22 1 25-1"/><path class="path2" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M110 163v-7c0-6 0-7 7-9 6 0 8 4 7 8v8"/><path class="path" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M84 23c0-2 2-4 0-6-3-1-5-1-7 2 1 4 3 5 7 4"/><path class="path2" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M175 150c2-2 5-4 9-3 4 2 5 5 5 8s1 5-1 8M43 150c3-2 5-4 9-3 5 2 5 5 5 8v8M204 150c2-2 5-3 8-3 9 3 5 10 6 16"/><path class="path" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M100 101v16M133 27c-2 0-3-1-4-3 0-2 1-4 5-4 2 0 2 2 3 4-4 2-4 6-4 10v10M64 58c0 2-1 3-3 3-3 0-4-2-5-3l4-4 1 1c4 4 9 3 13 3h10M90 47l4-1h46s4 0 7 5v13a425 425 0 01-1 34"/><path class="path2" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M196 147v16M22 147c0 5-1 10 1 16"/><path class="path" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M106 82c-3-1-4 1-4 3 1 3 3 5 7 5 3 1 5-1 7-2M131 73c5 4 6 7 2 10l-3 3c-1 4-5 5-9 4-4 0-5-3-5-6l1-18M121 62l6-1v-6c-4-1-7-1-10 2M128 61c8 3 9 6 4 12M173 84c5 2 5 3 0 6-3 0-3-2-5-3 0 0 2-3 4-3M116 60c2-4-1-6-5-5-4 0-7 1-6 6"/><path class="path2" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M43 163v-9c0-2 0-5-3-6s-6-1-9 1l-2 2c1 4-1 8 1 12M175 163v-9c0-2 0-5-4-6-3-1-6-1-8 1l-2 2v12M203 147v16"/><path class="path" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M108 101c0 3 1 6-1 9M125 34v10M84 65H73M84 80H73M109 34l-1 10M99 118c-3 1-3 3-2 5s3 2 5 1c2-2 2-5-2-6M106 61c-9 2-10 5-6 11M125 101v7M104 71c-8 4-8 8-2 13M150 122c-3 3-3 3 1 6 3 0 4-1 5-3-1-3-3-3-5-3M149 65h12M150 81h11M169 87h-19"/><path class="path2" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M22 144v-1M132 144v-1M196 144v-1"/></svg></a>
        </span><!-- end of .site-name -->
      </div><!-- end of #logo -->
        <div class="tagline">
                <a href="../tag/coding.html" >Coding (12)</a> &#124; 
                <a href="../tag/data.html" >Data (9)</a> &#124; 
                <a href="../tag/nus.html" >NUS (3)</a> &#124; 
                <a href="../tag/security.html" >Security (115)</a> &#124; 
                <a href="../tag/server.html" >Server (26)</a> &#124; 
                <a href="../tag/untagged.html" >Untagged (16)</a> &#124; 
                <a href="../archives.html" >Archives (164)</a>
        </div>
    </div>

  </header><!-- #masthead -->
  </div>
    <div id="content" class="site-content">
      <div class="container main-content-area">
        <div class="row">
          <div class="main-content-inner col-sm-12 col-md-12">
            <div id="primary" class="content-area">
              <div id="main" class="site-main" role="main">
                <div class="article-container">
<article>
  <div class="blog-item-wrap">
    <div class="post-inner-content">
      <header class="entry-header page-header">
        <span class="cat-item"><time datetime="2014-05-08 07:09:00+08:00">May 08, 2014</time></span>
        <h1 class="entry-title-single-page"><a href="../articles/how-i-cheated-and-won-a-quiz.html">How I (cheated and) won a quiz</a></h1>
      </header><!-- .entry-header -->
      <div class="entry-content">
        <p>The quiz in question. In case anyone is not familiar with it.
(attractive?) prizes to be won.</p>
</p><p><center></p><p><img alt="image0" src="//limbenjamin.com/media/soc_quiz.png" /></p>
<p></center></p><p>A quick packet capture revealed that the questions could be found <a class="reference external" href="https://demopage.in/fb/rapidfire/getquestion.php">here</a>
in JSON format. This is what is looked like. Interesting that the
answers were included even through &quot;marking&quot; was done only on the server
side. The questions were randomly generated.</p>
</p><p><center></p><p><img alt="image1" src="//limbenjamin.com/media/soc_qn.png" /></p>
<p></center></p><p>The quiz allowed you to make repeated attempts to improve your score so
the simplest way was to keep sending in your answers (automatically of
course!). Since I was too lazy to parse the JSON and I figured that they
probably didn't check for duplicate qns, I reused the same question
number. The bash script.</p>
</p></p><pre class="literal-block">
#!/bin/bash

while :
   do
      curl -k -i --raw -o /dev/null -X POST -d &quot;hiddenmemberid=(redacted)&amp;redirecturl=https%%3A%%2F%%2Fwww.facebook.com%%2Fnusschoolofcomputing%%2F%%3Fsk%%3Dapp\_1441375262772058&amp;token=3e191a89c94fda84460bfa8282d4d65a&amp;radio0=1&amp;qstnid0=4&amp;radio1=1&amp;qstnid1=4&amp;radio2=1&amp;qstnid2=4&amp;radio3=1&amp;qstnid3=4&amp;radio4=1&amp;qstnid4=4&amp;radio5=1&amp;qstnid5=4&amp;radio6=1&amp;qstnid6=4&amp;radio7=1&amp;qstnid7=4&amp;radio8=1&amp;qstnid8=4&amp;radio9=1&amp;qstnid9=4&amp;radio10=1&amp;qstnid10=4&amp;radio11=1&amp;qstnid11=4&amp;radio12=1&amp;qstnid12=4&amp;radio13=1&amp;qstnid13=4&amp;radio14=1&amp;qstnid14=4&quot; &quot;https://demopage.in/fb/rapidfire/resultfile.php&quot; -H &quot;Host: demopage.in&quot; -H &quot;Connection: keep-alive&quot; -H &quot;Cache-Control: max-age=0&quot; -H &quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,\*/\*;q=0.8&quot; -H &quot;Origin: https://demopage.in&quot; -H &quot;User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.131 Safari/537.36&quot; -H &quot;Content-Type: application/x-www-form-urlencoded&quot; -H &quot;Referer: https://demopage.in/fb/rapidfire/&quot; -H &quot;Accept-Encoding: gzip,deflate,sdch&quot; -H &quot;Accept-Language: en-US,en;q=0.8&quot; -H &quot;Cookie: PHPSESSID=(redacted)&quot;

   done
</pre>
<p>Obviously, I wasn't the only one to figure it out</p>
<p><center></p><p><img alt="image2" src="//limbenjamin.com/media/soc_results.png" /></p>
<p></center></p><div class="section" id="the-race-to-the-end">
<h2>The race to the end</h2>
</p><p>To win, you couldn't send the packets 1 at a time. You needed to run
multiple threads simultaneously. I had about 30 going on at the same
time. My upload/download was about 50kb/120kb. Since the packet size was
500bytes, I was sending about 100 packets/second which is 7500
points/sec.</p>
</p><p><center></p><p><img alt="image3" src="//limbenjamin.com/media/soc_cacti.png" /></p>
<p></center></p><p>Except it wasn't really true. Turns out that my server at home is more
powerful than theirs and it couldn't handle the load. This was not
obvious to me at first. I always had the impression that DDOS/DOS was
caused by bandwidth bottleneck. Attacks are measured in Gbps. Just
google &quot;ddos gbps&quot;. How could 50kbps possibly saturate their bandwidth?
Although it is highly unscientific, I did check that I was the only one
with points increasing at a rate which could be quantified in terms of
points/sec. Since I was already in the lead by close to 20,000,000
points, I could afford to slow down and do a little experiment. I
gradually decreased the rate at which I was sending packets until I hit
what is supposedly the limit of the server at 7pm. I logged all
responses received, slowing down the rate I was sending until the number
of errors stabilised. Upload/download was about 12kb/40kb or 24
packets/sec.</p>
</p><div class="block"></p><pre class="literal-block">
while :
   do
      output=$(curl ....)
      if ($output \| grep &quot;200&quot;)
         then echo &quot;ok&quot; &gt;&gt; access.log;
      else
         echo &quot;err&quot; &gt;&gt; error.log;
      fi
done
</pre>
<p></div></p></div>
<div class="section" id="round-2">
<h2>Round 2</h2>
</p><p>The quiz was modified midway in what I suppose was an attempt to thwart
the use of scripts. It was a puzzling move as the makers of the quiz had
already approved of the use of scripts, calling it the &quot;soc way&quot; and
giving the 3rd prize to those who used scripts. Anyway, it did not
really affect me. The change required a valid PHP session and so I
manually completed the quiz once to obtain the session cookie which is
used in future requests. The endpoint was also changed but a packet
capture revealed the new endpoint.</p>
</p><div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="ethicality">
<h2>Ethicality</h2>
</p><p>By the time I found out about the quiz, the top 5 spots or so were
already taken by scripters. Therefore, I wasn't depriving any legitimate
player a chance at the prize, so I reasoned that it was ok. The DOS
attack was unintentional, I had no idea that a single person with a
1mbps upload connection could DOS an entire instance and cause a number
of websites to be unavailable. As for the prizes, I thought that I would
be banned/blocked. After all, the main motivation was to destress and
have fun.</p>
</p><p>The final results</p>
</p><p><center></p><p><img alt="image4" src="//limbenjamin.com/media/soc_results2.png" /></p>
<p></center></p></div>

      </div><!-- .entry-content -->
      <br /><br />
      <div class="article_meta">
        Tags:
          <a href="../tag/security.html">Security</a>        <br />
        <div class="similararticleline"></div>
        <h2>Similar Articles</h2>
          <div class="similararticlerow">
              <blockquote class="similar_posts">
              <a href="../articles/migrating-rsyslog-to-splunk.html"><b>Migrating rsyslog to Splunk
              (96% Similar) - </b>
              I recently decided to migrate my server cluster's logging mechanism from rsyslog to Splunk. My previous setup was to use rsyslog to centralise all logging onto /var/remotelog/ on a central ...</a>
              </blockquote>
              <blockquote class="similar_posts">
              <a href="../articles/software-versioning.html"><b>Software Versioning
              (95% Similar) - </b>
              I have recently started managing yet another server. The server is running Ubuntu 14.04 LTS and therefore support is good for another 5 years. Just to be safe, I double checked the openssl ...</a>
              </blockquote>
              <blockquote class="similar_posts">
              <a href="../articles/mysql-optimization.html"><b>mysql optimization
              (93% Similar) - </b>
              Recently did quite a lot of mysql related administration. Found quite a few ways to optimise that may make future administration easier. 1) If you are going to add/drop databases very frequently, ...</a>
              </blockquote>
              <blockquote class="similar_posts">
              <a href="../articles/replicating-uvb-76.html"><b>Replicating UVB-76
              (93% Similar) - </b>
              For the uninitiated, UVB-76 is a station that broadcasts coded messages over AM radio. It is still active with messages transmitted as recently as Oct 2016 and is speculated to be related to the ...</a>
              </blockquote>
          </div>
      </div>
      <br />
    </div>
  </div>
</article><!-- #post-## -->
                </div>
              </div><!-- #main -->
          </div><!-- #primary -->
        </div>
      </div><!-- close .row -->
    </div><!-- close .container -->
  </div><!-- close .site-content -->

  <div id="mail" class="overlay">
    <div class="popup">
      <a class="close" href="#">&times;</a>
      <div id="popup_content">
      </div>
    </div>
  </div>

  <div id="footer-area">
    <footer id="colophon" class="site-footer" role="contentinfo">
      <div class="site-info container">
        <div class="row">
                    <div class="copyright col-md-12">
                    <a href="../pages/privacy-policy-disclaimer">Privacy & Disclaimer</a> | 
                    <a href="../feeds/all.atom.xml">Atom Feed</a> | 
                    <a href="../sitemap.xml">Sitemap</a><br />
                    This site uses the <a href="https://github.com/limbenjamin/voce">voce</a> theme by <a href="//limbenjamin.com/">Benjamin Lim</a><br />
                    Page generated on Sun Aug 21 21:53:30 2022<br />
                    &copy; 2012-2022 <a href="..">Benjamin Lim</a> </div>
        </div>
      </div><!-- .site-info -->
      <div class="scroll-to-top" style="display: none;"><i class="fa fa-angle-up"></i></div><!-- .scroll-to-top -->
    </footer><!-- #colophon -->
  </div>

  <script type="text/javascript">
    window.addEventListener('load', function(){
    if (window.location.pathname != '/' && window.location.pathname != '/index.html'){
      window.scroll(0, document.getElementById('main').offsetTop);
    }})
  </script>


  <script type="text/javascript">
    var _paq = _paq || [];
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="//limbenjamin.com/a/";
      _paq.push(['setTrackerUrl', u+'js/']);
      _paq.push(['setSiteId', 1]);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'js/a.js'; s.parentNode.insertBefore(g,s);
    })();
  </script>
  <script type="text/javascript" src="../theme/js/functions.min.js"></script>
  <noscript><p><img src="//limbenjamin.com/a/a.php?idsite=1" style="border:0;" alt="" /></p></noscript>


</body>
</html>